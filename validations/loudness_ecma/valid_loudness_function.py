import numpy as np
import matplotlib.pyplot as plt

from mosqito.functions.loudness_ecma_spain.loudness_function import (
    loudness_function as loudness_function,
)

p = np.linspace(10, 100, 100)
loudness = [loudness_function(2e-5 * 10 ** (i / 20)) for i in p]
plt.semilogy(p, loudness, label="ECMA")

p_ref = [
    13.987476,
    15.9721985,
    18.109982,
    20.782942,
    23.303232,
    26.129642,
    29.567616,
    33.082165,
    37.132286,
    42.405235,
    47.44942,
    51.80556,
    56.620693,
    62.19986,
    68.238014,
    72.82331,
    79.31967,
    84.89865,
    90.40075,
    94.90907,
    98.729164,
    102.396385,
    105.2226,
    107.590416,
    109.57592,
]

loud_ref = [
    0.020996287,
    0.029044019,
    0.039844647,
    0.0555822,
    0.07562439,
    0.10120133,
    0.13886018,
    0.18895733,
    0.2529075,
    0.36485842,
    0.49659508,
    0.6591871,
    0.86782557,
    1.2211897,
    1.7043209,
    2.3195395,
    3.431377,
    4.909524,
    7.2618318,
    10.302499,
    14.493973,
    20.221483,
    27.514244,
    35.91071,
    46.47905,
]

plt.semilogy(p_ref, loud_ref, label="Buus et al.")

p_ref1 = [
    6.598919,
    8.838655,
    11.250792,
    14.17477,
    17.785425,
    20.533108,
    23.620234,
    26.878784,
    31.16102,
    35.784645,
    40.063473,
    44.85609,
    48.621613,
    53.92802,
    58.548725,
    64.02948,
    70.02354,
    76.3624,
    82.87268,
    87.32732,
    92.63762,
    97.607506,
    101.3779,
    104.46454,
]

loud_ref1 = [
    0.002630106,
    0.0051425043,
    0.010632731,
    0.021176357,
    0.047157302,
    0.076508306,
    0.11306698,
    0.17023043,
    0.2377996,
    0.32601807,
    0.3997006,
    0.50857294,
    0.6120943,
    0.8082804,
    0.9908526,
    1.4907696,
    2.2847574,
    3.9156787,
    6.8367267,
    10.09929,
    15.481487,
    25.099924,
    36.40073,
    52.800743,
]

plt.semilogy(p_ref1, loud_ref1, label="Buus et al. 1")
plt.legend()
plt.show()

pass